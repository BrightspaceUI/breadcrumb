<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../d2l-colors/d2l-colors.html">
<link rel="import" href="../d2l-link/d2l-link.html">
<link rel="import" href="../d2l-icons/tier1-icons.html">
<link rel="import" href="../d2l-polymer-behaviors/d2l-dom.html">
<link rel="import" href="../iron-icon/iron-icon.html">
<link rel="import" href="./d2l-breadcrumb-icons.html">

<dom-module id="d2l-breadcrumb">
	<template strip-whitespace>
		<style>
			:host {
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
				display: -webkit-inline-box;
				display: -ms-inline-flexbox;
				display: inline-flex;
			}

			div.d2l-breadcrumb-wrapper {
				-webkit-box-align: center;
				-ms-flex-align: center;
				align-items: center;
			}

			div.d2l-breadcrumb-wrapper.compact {
				display: -webkit-flex;
				display: -webkit-box;
				display: -ms-flexbox;
				display: flex;
				-webkit-box-orient: horizontal;
				-webkit-box-direction: reverse;
    			-ms-flex-direction: row-reverse;
        		flex-direction: row-reverse;
			}

			iron-icon {
				--iron-icon-height: 8px;
    			--iron-icon-width: 8px;
				--iron-icon-fill-color: rgb(86, 90, 92);
				padding-left: 10px;
				padding-right: 5px;
			}
			div.d2l-breadcrumb-wrapper.compact iron-icon {
				padding-right: 10px;
				padding-left: 0;
			}

		</style>
		<div class$="[[_getConditionalClasses(_compact)]]" role="navigation" aria-label$="[[text]]">
			<d2l-link href$="[[href]]">[[text]]</d2l-link>
			<iron-icon icon="[[_toggle(_compact, _compactIcon, _regularIcon)]]"></iron-icon>
		</div>
	</template>

	<script>
		Polymer({
			is: 'd2l-breadcrumb',
			properties: {
				/**
				* Item href
				*/
				href: {
					type: String,
					value: '#'
				},
				/**
				* Item text
				*/
				text: {
					type: String,
					value: ''
				},
				/**
				* Whether in compact mode
				*/
				_compact: {
					type: Boolean,
					value: false
				},
				_compactIcon: {
					type: String,
					value: 'd2l-breadcrumb:chevron-left'
				},
				_regularIcon: {
					type: String,
					value: 'd2l-breadcrumb:chevron-right'
				}
			},
			attached: function() {
				this._ensureAttribute('role', 'listitem');
				this._compact = this._getCompactProperty();
				Polymer.RenderStatus.afterNextRender(this, function() {
					this._compact = this._getCompactProperty();
				});
			},
			_toggle: function(cond, t, f) { return cond ? t : f; },
			_getConditionalClasses: function(compact) {
				var classes = ['d2l-breadcrumb-wrapper'];
				if (compact) { classes.push('compact'); }
				return classes.join(' ');
			},
			_getCompactProperty: function() {
				var compact = null;
				D2L.Dom.findComposedAncestor(this, function(node) {
					if (node.tagName !== 'D2L-BREADCRUMBS') {
						return false;
					}
					compact = node.compact;
					return true;
				});
				return compact;
			}
		});
	</script>
</dom-module>
