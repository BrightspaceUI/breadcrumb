<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../d2l-colors/d2l-colors.html">
<link rel="import" href="../d2l-icons/d2l-icon.html">
<link rel="import" href="../d2l-link/d2l-link.html">
<link rel="import" href="../d2l-icons/tier1-icons.html">
<link rel="import" href="../d2l-polymer-behaviors/d2l-dom.html">

<dom-module id="d2l-breadcrumb">
	<template strip-whitespace>
		<style>
			:host {
				display: inline-flex;
				align-items: center;
			}

			div.wrapper {
				align-items: center;
			}

			div.wrapper.compact {
				display: -webkit-flex;
				-webkit-flex-direction: row-reverse;
				flex-direction: row-reverse;
			}

			d2l-icon {
				height: 10px;
			}

		</style>
		<div class$="[[_getConditionalClasses(_compact)]]">
			<d2l-link href$="[[href]]">[[text]]</d2l-link>
			<d2l-icon icon="[[_toggle(_compact, _compactIcon, _regularIcon)]]"></d2l-icon>
		</div>
	</template>

	<script>
		Polymer({
			is: 'd2l-breadcrumb',
			properties: {
				/**
				* Item href
				*/
				href: {
					type: String,
					value: '#'
				},
				/**
				* Item text
				*/
				text: {
					type: String,
					value: ''
				},
				/**
				* Whether in compact mode
				*/
				_compact: {
					type: Boolean,
					value: false
				},
				_compactIcon: {
					type: String,
					value: 'd2l-tier1:chevron-left'
				},
				_regularIcon: {
					type: String,
					value: 'd2l-tier1:chevron-right'
				}
			},
			ready: function() {
				this._ensureAttribute('role', 'listitem');
			},
			attached: function() {
				this._compact = this._getCompactProperty();
				Polymer.RenderStatus.afterNextRender(this, function() {
					this._compact = this._getCompactProperty();
				});
			},
			_toggle: function(cond, t, f) { return cond ? t : f; },
			_getConditionalClasses: function(compact) {
				var classes = ['wrapper'];
				if (compact) { classes.push('compact'); }
				return classes.join(' ');
			},
			_getCompactProperty: function() {
				var compact = null;
				D2L.Dom.findComposedAncestor(this, function(node) {
					if (node.tagName !== 'D2L-BREADCRUMBS') {
						return false;
					}
					compact = node.compact;
					return true;
				});
				return compact;
			}
		});
	</script>
</dom-module>
